(this["webpackJsonpfrontend-imessage-clone"]=this["webpackJsonpfrontend-imessage-clone"]||[]).push([[0],{60:function(e,t,a){},64:function(e,t,a){},65:function(e,t,a){},69:function(e,t,a){},71:function(e,t,a){},72:function(e,t,a){},73:function(e,t,a){},74:function(e,t,a){},75:function(e,t,a){"use strict";a.r(t);var c=a(5),n=a(2),s=a.n(n),i=a(17),o=a.n(i),r=(a(60),a(11)),l=(a(64),a(20)),d=a(89),u=a(87),j=(a(65),a(46)),h=a.n(j),b=a(47),m=a.n(b),f=a(22),O=Object(f.b)({name:"chat",initialState:{chatId:null,chatName:null},reducers:{setChat:function(e,t){e.chatId=t.payload.chatId,e.chatName=t.payload.chatName}}}),p=O.actions.setChat,v=function(e){return e.chat.chatId},g=function(e){return e.chat.chatName},x=O.reducer,N=a(24),S=N.a.initializeApp({apiKey:"AIzaSyBatyYnRTwtTgsWNjsCVOAWKDb2ykfd-c0",authDomain:"imessage-clone-17fa7.firebaseapp.com",databaseURL:"https://imessage-clone-17fa7.firebaseio.com/",projectId:"imessage-clone-17fa7",storageBucket:"imessage-clone-17fa7.appspot.com"}).firestore(),y=N.a.auth(),_=new N.a.auth.GoogleAuthProvider,w=S,C=(a(69),a(50));var k=function(e){var t,a,s,i,o=e.id,u=e.chatName,j=Object(r.b)(),h=Object(n.useState)([]),b=Object(l.a)(h,2),m=b[0],f=b[1];return Object(n.useEffect)((function(){w.collection("chats").doc(o).collection("message").orderBy("timestamp","desc").onSnapshot((function(e){return f(e.docs.map((function(e){return e.data()})))}))}),[o]),Object(c.jsxs)("div",{onClick:function(){return j(p({chatId:o,chatName:u}))},className:"sidebarChat",children:[Object(c.jsx)(d.a,{src:null===(t=m[0])||void 0===t?void 0:t.photo,className:"sidebarChat_avatar"}),Object(c.jsxs)("div",{className:"sidebarChat_info",children:[Object(c.jsx)("h3",{children:u}),Object(c.jsx)("p",{children:null===(a=m[0])||void 0===a?void 0:a.message}),Object(c.jsx)("small",{children:C.a(new Date(null===(s=m[0])||void 0===s||null===(i=s.timestamp)||void 0===i?void 0:i.toDate()).toLocaleString())})]})]})},I=Object(f.b)({name:"user",initialState:{user:null},reducers:{login:function(e,t){e.user=t.payload},logout:function(e){e.user=null}}}),D=I.actions,B=D.login,A=D.logout,E=function(e){return e.user.user},M=I.reducer;var W=function(){var e=Object(r.c)(E),t=Object(n.useState)([]),a=Object(l.a)(t,2),s=a[0],i=a[1];return Object(n.useEffect)((function(){w.collection("chats").onSnapshot((function(e){return i(e.docs.map((function(e){return{id:e.id,data:e.data()}})))}))}),[]),Object(c.jsxs)("div",{className:"sidebar",children:[Object(c.jsxs)("div",{className:"sidebar_header",children:[Object(c.jsx)(d.a,{onClick:function(){return y.signOut()},src:e.photo,className:"sidebar_avatar"}),Object(c.jsxs)("div",{className:"sidebar_input",children:[Object(c.jsx)(h.a,{}),Object(c.jsx)("input",{placeholder:"Search"})]}),Object(c.jsx)(u.a,{variant:"outlined",className:"sidebar_inputButton",onClick:function(){var e=prompt("Please enter a chat name");e&&w.collection("chats").add({chatName:e})},children:Object(c.jsx)(m.a,{})})]}),Object(c.jsx)("div",{className:"sidebar_chats",children:s.map((function(e){var t=e.id,a=e.data.chatName;return Object(c.jsx)(k,{id:t,chatName:a},t)}))})]})},L=(a(71),a(49)),R=a.n(L),T=(a(72),Object(n.forwardRef)((function(e,t){e.id;var a=e.contents,n=(a.uid,a.message),s=a.email,i=a.photo,o=a.timestamp,l=(a.displayName,Object(r.c)(E));return Object(c.jsxs)("div",{ref:t,className:"message ".concat(l.email===s&&"message_sender"),children:[Object(c.jsx)(d.a,{className:"message_photo",src:i}),Object(c.jsx)("p",{children:n}),Object(c.jsx)("small",{children:new Date(null===o||void 0===o?void 0:o.toDate()).toLocaleString()})]})}))),P=a(48);var z=function(){var e=Object(n.useState)(""),t=Object(l.a)(e,2),a=t[0],s=t[1],i=Object(r.c)(g),o=Object(r.c)(v),d=Object(n.useState)([]),j=Object(l.a)(d,2),h=j[0],b=j[1],m=Object(r.c)(E);return Object(n.useEffect)((function(){o&&w.collection("chats").doc(o).collection("message").orderBy("timestamp","desc").onSnapshot((function(e){return b(e.docs.map((function(e){return{id:e.id,data:e.data()}})))}))}),[o]),Object(c.jsxs)("div",{className:"chat",children:[Object(c.jsxs)("div",{className:"chat_header",children:[Object(c.jsxs)("h4",{children:["To:",Object(c.jsx)("span",{children:i})]}),Object(c.jsx)("strong",{children:"Details"})]}),Object(c.jsx)("div",{className:"chat_message",children:Object(c.jsx)(P.a,{children:h.map((function(e){var t=e.id,a=e.data;return Object(c.jsx)(T,{contents:a},t)}))})}),Object(c.jsxs)("div",{className:"chat_input",children:[Object(c.jsxs)("form",{children:[Object(c.jsx)("input",{onChange:function(e){return s(e.target.value)},value:a,placeholder:"iMessage"}),Object(c.jsx)("button",{onClick:function(e){e.preventDefault(),w.collection("chats").doc(o).collection("message").add({timestamp:N.a.firestore.FieldValue.serverTimestamp(),message:a,uid:m.uid,photo:m.photo,email:m.email,displayName:m.displayName}),s("")},children:"Send Message"})]}),Object(c.jsx)(u.a,{children:Object(c.jsx)(R.a,{className:"chat_mic"})})]})]})};a(73);var G=function(){return Object(c.jsxs)("div",{className:"iMessage",children:[Object(c.jsx)(W,{}),Object(c.jsx)(z,{})]})},J=a(88);a(74);var K=function(){return Object(c.jsxs)("div",{className:"login",children:[Object(c.jsx)("div",{className:"login_logo",children:Object(c.jsx)("img",{src:"https://i.pinimg.com/originals/0f/bf/16/0fbf1634d3df83b601b456f3c6aa3c7d.jpg",alt:"logo"})}),Object(c.jsx)("h1",{children:"iMessage"}),Object(c.jsx)(J.a,{onClick:function(){y.signInWithPopup(_).catch((function(e){return alert(e.message)}))},children:"SIGN IN"})]})};var U=function(){var e=Object(r.c)(E),t=Object(r.b)();return Object(n.useEffect)((function(){y.onAuthStateChanged((function(e){t(e?B({uid:e.uid,photo:e.photoURL,email:e.email,displayName:e.displayName}):A())}))}),[]),Object(c.jsx)("div",{className:"app",children:e?Object(c.jsx)(G,{}):Object(c.jsx)(K,{})})},V=Object(f.a)({reducer:{user:M,chat:x}});Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(Object(c.jsx)(s.a.StrictMode,{children:Object(c.jsx)(r.a,{store:V,children:Object(c.jsx)(U,{})})}),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[75,1,2]]]);
//# sourceMappingURL=main.48a2360c.chunk.js.map